<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : DTS : /DTS/admin/send_mass_email.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of DTS</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Mon May  5 14:14:03 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='DTS/admin';
filename='send_mass_email.php.source.html';
cookiekey='phpxref_dts';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/DTS/admin/</a> -> <a href="send_mass_email.php.html">send_mass_email.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="send_mass_email.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="send_mass_email.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;? 
<a name="l2"><span class="linenum">   2</span></a>  <span class="keyword">include_once</span> <a class="filename" href="../../DTS/includes/dts_functions.php.html" onMouseOver="reqPopup(event, 'dts_functions.php', '../../DTS/includes/dts_functions.php')"> (&quot;../includes/dts_functions.php&quot;)</a>;
<a name="l3"><span class="linenum">   3</span></a>  
<a name="l4"><span class="linenum">   4</span></a>  die(&quot;DO NOT USE!&quot;);
<a name="l5"><span class="linenum">   5</span></a>  
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// fetch list of recipients</span>
<a name="l7"><span class="linenum">   7</span></a>  <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT d.instrument_id, d.date_completed, d.finalized, d.resellerkey,
<a name="l8"><span class="linenum">   8</span></a>          r.userkey, r.firstname, r.lastname, r.email
<a name="l9"><span class="linenum">   9</span></a>      FROM la_data d
<a name="l10"><span class="linenum">  10</span></a>          LEFT JOIN registrants r ON d.userkey = r.userkey
<a name="l11"><span class="linenum">  11</span></a>      WHERE d.instrument_id LIKE 'LDMA%' 
<a name="l12"><span class="linenum">  12</span></a>          AND d.date_released BETWEEN '2013-01-01' AND '2013-06-07'
<a name="l13"><span class="linenum">  13</span></a>          AND d.resellerkey &lt;&gt; 1000000113 AND d.resellerkey &lt;&gt; 1000001137
<a name="l14"><span class="linenum">  14</span></a>          **** DO NOT USE THIS PAGE without modifying the query first. ****
<a name="l15"><span class="linenum">  15</span></a>      GROUP BY d.userkey&quot;;
<a name="l16"><span class="linenum">  16</span></a>  <a class="var it8672" onMouseOver="hilite(8672)" onMouseOut="lolite()" onClick="logVariable('rsRecipients')" href="../../_variables/rsRecipients.html">$rsRecipients</a> = <a class="phpfunction" onClick="logFunction('mysql_query')" href="../../_functions/mysql_query.html" onMouseOver="phpfuncPopup(event,'mysql_query')">mysql_query</a>(<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>) or die(&quot;ERROR fetching list of recipients! &quot;);
<a name="l17"><span class="linenum">  17</span></a>  
<a name="l18"><span class="linenum">  18</span></a>  **** DO NOT USE THIS PAGE without modifying the query first. ****
<a name="l19"><span class="linenum">  19</span></a>  
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment">// prep email</span>
<a name="l21"><span class="linenum">  21</span></a>  <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('from')" href="../../_variables/from.html">$from</a> = 'service@lectica.org';
<a name="l22"><span class="linenum">  22</span></a>  <a class="var it8677" onMouseOver="hilite(8677)" onMouseOut="lolite()" onClick="logVariable('email_subject')" href="../../_variables/email_subject.html">$email_subject</a> = &quot;Corrections to some of our LDMA reports&quot;;
<a name="l23"><span class="linenum">  23</span></a>  <a class="var it8678" onMouseOver="hilite(8678)" onMouseOut="lolite()" onClick="logVariable('email_body')" href="../../_variables/email_body.html">$email_body</a> = &quot;Hello [NAME], 
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  We're writing to you because you have taken our LDMA (leadership decision making) assessment in the past 6 months. A couple weeks ago, we found an error with the calculations that we use to generate the reports on the LDMA. Unfortunately, this error caused some reports to display incorrect results, as well as feedback that wasn't as accurate as it could be. 
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  Because of this correction, the next time you view your report, the charts and text on four of the LDMA report sections (perspective coordination, collaborative capacity, contextual thinking, and decision-making process)  may look slightly different from the last time you saw it. We're very sorry for any confusion that this may cause.
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  Just to be clear, the LAS scores shown on your reports have not been changed. Also, we are not retracting any reports we've produced, nor removing sections from the reports. The charts displaying each of the five LDMA scales may show adjusted numbers, and the text accompanying them may show slightly different feedback and recommendations.
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  As always, please contact us with any questions about our assessments or reports.
<a name="l32"><span class="linenum">  32</span></a>  
<a name="l33"><span class="linenum">  33</span></a>  Happy lifelong learning,
<a name="l34"><span class="linenum">  34</span></a>  The Lectica team&quot;;
<a name="l35"><span class="linenum">  35</span></a>  
<a name="l36"><span class="linenum">  36</span></a>  
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>  while (<a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a> = <a class="phpfunction" onClick="logFunction('mysql_fetch_assoc')" href="../../_functions/mysql_fetch_assoc.html" onMouseOver="phpfuncPopup(event,'mysql_fetch_assoc')">mysql_fetch_assoc</a>(<a class="var it8672" onMouseOver="hilite(8672)" onMouseOut="lolite()" onClick="logVariable('rsRecipients')" href="../../_variables/rsRecipients.html">$rsRecipients</a>)) {
<a name="l39"><span class="linenum">  39</span></a>  
<a name="l40"><span class="linenum">  40</span></a>      <a class="var it8684" onMouseOver="hilite(8684)" onMouseOut="lolite()" onClick="logVariable('this_body')" href="../../_variables/this_body.html">$this_body</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>(&quot;[NAME]&quot;, <a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>['firstname'], <a class="var it8678" onMouseOver="hilite(8678)" onMouseOut="lolite()" onClick="logVariable('email_body')" href="../../_variables/email_body.html">$email_body</a>);
<a name="l41"><span class="linenum">  41</span></a>      <a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('to')" href="../../_variables/to.html">$to</a> = <a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>['email'];
<a name="l42"><span class="linenum">  42</span></a>  
<a name="l43"><span class="linenum">  43</span></a>      <a class="function" onClick="logFunction('sendEmail')" href="../../_functions/sendemail.html" onMouseOver="funcPopup(event,'sendemail')">sendEmail</a>(<a class="var it425" onMouseOver="hilite(425)" onMouseOut="lolite()" onClick="logVariable('to')" href="../../_variables/to.html">$to</a>, <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('from')" href="../../_variables/from.html">$from</a>, <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('from')" href="../../_variables/from.html">$from</a>, <a class="var it8677" onMouseOver="hilite(8677)" onMouseOut="lolite()" onClick="logVariable('email_subject')" href="../../_variables/email_subject.html">$email_subject</a>, <a class="var it8684" onMouseOver="hilite(8684)" onMouseOut="lolite()" onClick="logVariable('this_body')" href="../../_variables/this_body.html">$this_body</a>);
<a name="l44"><span class="linenum">  44</span></a>      <a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = sprintf(&quot;UPDATE registrants SET date_today = <a class="function" onClick="logFunction('NOW')" href="../../_functions/now.html" onMouseOver="funcPopup(event,'now')">NOW</a>() WHERE userkey = %s&quot;, <a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>['userkey']);
<a name="l45"><span class="linenum">  45</span></a>      <a class="var it401" onMouseOver="hilite(401)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = <a class="phpfunction" onClick="logFunction('mysql_query')" href="../../_functions/mysql_query.html" onMouseOver="phpfuncPopup(event,'mysql_query')">mysql_query</a>(<a class="var it288" onMouseOver="hilite(288)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>) or die(&quot;ERROR updating date_today.&quot;);
<a name="l46"><span class="linenum">  46</span></a>      echo &quot;Email sent to {<a class="var it444" onMouseOver="hilite(444)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>['email']}.&lt;br /&gt;&quot;;
<a name="l47"><span class="linenum">  47</span></a>  
<a name="l48"><span class="linenum">  48</span></a>  }
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'sendemail': ['sendemail', '', [['DTS/includes','general_custom_functions.php',50],['DTS/includes/common/lib/email','KT_Email.class.php',152],['DTS/includes','dts_functions.php',270],['DTS/includes','dts_functions_2.php',93],['DTS/includes/common/lib/email','KT_email.class.php',152]], 51],
'now': ['now', '', [['DTS/jQuery/includes','jquery-1.4.2.js',822]], 80],
'mysql_query': ['mysql_query', '', [], 5079],
'mysql_fetch_assoc': ['mysql_fetch_assoc', '', [], 9670],
'str_replace': ['str_replace', '', [], 1019]};
CLASS_DATA={
};
CONST_DATA={
};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Mon May  5 14:14:03 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
